<!doctype html>
<html lang="ko" class="h-full">
<head>
  <script type="module" src="./assets/app.js" defer></script>
  <script>window.API_BASE="https://cjsend.erickparkcha.workers.dev";</script>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Thunder 전적검색 v1</title>
  <!-- Tailwind CDN (데모용). 프로덕션은 빌드 권장 -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    // 다크/라이트 자동
    if (localStorage.theme === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
      document.documentElement.classList.add('dark')
    } else { document.documentElement.classList.remove('dark') }
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            thunder: {
              50:'#f5f8ff',100:'#e6eeff',200:'#c7d7ff',300:'#9cb7ff',
              400:'#6f92ff',500:'#446dff',600:'#2d4ee3',700:'#243db7',
              800:'#1e3292',900:'#192a77',950:'#0e173f'
            }
          }
        }
      }
    }
  </script>
  <!-- 파비콘 404 방지: data URI -->
  <link rel="icon" type="image/svg+xml" href='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64"><path fill="%23446dff" d="M28 2 6 38h16l-6 24 32-40H34l10-20z"/></svg>'>
  <meta name="color-scheme" content="light dark">
  <style>
    /* 스켈레톤 */
    .skeleton{position:relative;overflow:hidden;background:linear-gradient(90deg,rgba(0,0,0,.08),rgba(0,0,0,.12),rgba(0,0,0,.08))}
    .skeleton::after{content:"";position:absolute;inset:0;background:linear-gradient(90deg,transparent,rgba(255,255,255,.35),transparent);transform:translateX(-100%);animation:shimmer 1.2s infinite}
    @keyframes shimmer{100%{transform:translateX(100%)}}
    /* 토스트 */
    .toast-enter{animation:toast-in .18s ease-out}
    @keyframes toast-in{from{transform:translateY(8px);opacity:.0}to{transform:translateY(0);opacity:1}}
  </style>
</head>
<body class="h-full bg-white text-gray-900 dark:bg-gray-950 dark:text-gray-100">
  <header class="sticky top-0 z-20 border-b border-gray-200 dark:border-gray-800 bg-white/70 dark:bg-gray-950/70 backdrop-blur">
    <div class="max-w-5xl mx-auto px-4 py-3 flex items-center gap-3">
      <svg width="28" height="28" viewBox="0 0 64 64" aria-hidden="true"><path fill="#446dff" d="M28 2 6 38h16l-6 24 32-40H34l10-20z"/></svg>
      <h1 class="font-semibold text-lg">Thunder 전적검색</h1>
      <form id="searchForm" class="ms-auto flex gap-2 w-full max-w-md" role="search" aria-label="소환사 검색">
        <label for="q" class="sr-only">Riot ID 입력 (예: name#KR1)</label>
        <input id="q" name="q" required
          class="flex-1 rounded-lg border border-gray-300 dark:border-gray-700 px-3 py-2 text-sm bg-white dark:bg-gray-900"
          placeholder="Riot ID (예: Hide on bush#KR1)" autocomplete="off" />
        <button id="submitBtn" type="submit"
          class="rounded-lg bg-thunder-600 hover:bg-thunder-700 px-4 py-2 text-white text-sm focus:outline-none focus:ring ring-thunder-400"
          aria-label="검색">검색</button>
      </form>
    </div>
  </header>

  <main class="max-w-5xl mx-auto px-4 py-6">
    <section id="status" class="sr-only" aria-live="polite"></section>

    <!-- 결과 영역 -->
    <div id="result" class="grid gap-4">
      <!-- 초기 안내 -->
      <div id="empty" class="text-sm text-gray-600 dark:text-gray-400">
        Riot ID를 입력하고 Enter 또는 검색을 누르세요.
      </div>

      <!-- 스켈레톤 -->
      <div id="skeleton" class="hidden grid gap-4">
        <div class="rounded-xl p-4 border border-gray-200 dark:border-gray-800">
          <div class="h-5 w-40 skeleton rounded mb-3"></div>
          <div class="h-4 w-64 skeleton rounded"></div>
        </div>
        <div class="grid md:grid-cols-3 gap-4">
          <div class="h-48 skeleton rounded-xl"></div>
          <div class="h-48 skeleton rounded-xl"></div>
          <div class="h-48 skeleton rounded-xl"></div>
        </div>
      </div>

      <!-- 데이터 -->
      <div id="profile" class="hidden rounded-xl border border-gray-200 dark:border-gray-800 p-4">
        <div class="flex items-center gap-3">
          <img id="icon" alt="" width="48" height="48" class="rounded-lg" loading="lazy">
          <div>
            <h2 id="name" class="font-semibold"></h2>
            <p id="level" class="text-xs text-gray-600 dark:text-gray-400"></p>
          </div>
        </div>
      </div>

      <div id="charts" class="hidden grid md:grid-cols-3 gap-4">
        <div class="rounded-xl border border-gray-200 dark:border-gray-800 p-4">
          <h3 class="text-sm font-medium mb-2">KDA(최근 10경기)</h3>
          <canvas id="kdaBar" aria-label="KDA 차트" role="img"></canvas>
        </div>
        <div class="rounded-xl border border-gray-200 dark:border-gray-800 p-4">
          <h3 class="text-sm font-medium mb-2">승률</h3>
          <canvas id="winDonut" aria-label="승률 도넛" role="img"></canvas>
        </div>
        <div class="rounded-xl border border-gray-200 dark:border-gray-800 p-4">
          <h3 class="text-sm font-medium mb-2">포지션 분포</h3>
          <canvas id="posPie" aria-label="포지션 분포" role="img"></canvas>
        </div>
      </div>

      <!-- 빈 상태 -->
      <div id="emptyGames" class="hidden text-sm text-gray-600 dark:text-gray-400">
        최근 경기 데이터가 없습니다.
      </div>
    </div>
  </main>

  <!-- 토스트 -->
  <div id="toast" class="fixed bottom-4 right-4 hidden max-w-sm rounded-xl border border-red-200 dark:border-red-900 bg-red-50 dark:bg-red-950 text-red-800 dark:text-red-200 p-3 text-sm shadow-lg toast-enter" role="alert" aria-live="assertive"></div>

  <!-- 하단 에러 배지 -->
  <div id="errBadge" class="fixed bottom-2 left-2 text-xs text-gray-600 dark:text-gray-400"></div>

  <!-- App -->
  <script type="module" src="./assets/app.js"></script>
</body>
</html>
